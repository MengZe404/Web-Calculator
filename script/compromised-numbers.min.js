!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).compromiseNumbers=t()}(this,(function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e){return(t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function r(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var i="twenty|thirty|forty|fifty|sixty|seventy|eighty|ninety|fourty",u=function(e,t){var n=e.match("#Value+");if(n.has("#NumericValue #NumericValue")&&(n.has("#Value @hasComma #Value")?n.splitAfter("@hasComma"):n=n.splitAfter("#NumericValue")),n.has("#Value #Value #Value")&&!n.has("#Multiple")&&n.has("("+i+") #Cardinal #Cardinal")&&(n=n.splitAfter("("+i+") #Cardinal")),n.has("#Value #Value")){n.has("#NumericValue #NumericValue")&&(n=n.splitOn("#Year")),n.has("("+i+") (eleven|twelve|thirteen|fourteen|fifteen|sixteen|seventeen|eighteen|nineteen)")&&(n=n.splitAfter("("+i+")"));var r=n.match("#Cardinal #Cardinal");r.found&&!n.has("(point|decimal)")&&(r.has("#Cardinal (#Multiple|point|decimal)")||r.has("("+i+") #Cardinal")||r.has("#Multiple #Value")||r.terms().forEach((function(e){n=n.splitOn(e)}))),n.match("#Ordinal #Ordinal").match("#TextValue").found&&!n.has("#Multiple")&&(n.has("("+i+") #Ordinal")||(n=n.splitAfter("#Ordinal"))),n.has("#Ordinal #Cardinal")&&(n=n.splitBefore("#Cardinal+")),n.has("#TextValue #NumericValue")&&!n.has("("+i+"|#Multiple)")&&(n=n.splitBefore("#NumericValue+"))}return n.has("#NumberRange")&&(n=n.splitAfter("#NumberRange")),"number"==typeof t&&(n=n.get(t)),n},a=function(e){for(var t=[{reg:/^(minus|negative)[\s\-]/i,mult:-1},{reg:/^(a\s)?half[\s\-](of\s)?/i,mult:.5}],n=0;n<t.length;n++)if(!0===t[n].reg.test(e))return{amount:t[n].mult,str:e.replace(t[n].reg,"")};return{amount:1,str:e}},o={ones:{zeroth:0,first:1,second:2,third:3,fourth:4,fifth:5,sixth:6,seventh:7,eighth:8,ninth:9,zero:0,one:1,two:2,three:3,four:4,five:5,six:6,seven:7,eight:8,nine:9},teens:{tenth:10,eleventh:11,twelfth:12,thirteenth:13,fourteenth:14,fifteenth:15,sixteenth:16,seventeenth:17,eighteenth:18,nineteenth:19,ten:10,eleven:11,twelve:12,thirteen:13,fourteen:14,fifteen:15,sixteen:16,seventeen:17,eighteen:18,nineteen:19},tens:{twentieth:20,thirtieth:30,fortieth:40,fourtieth:40,fiftieth:50,sixtieth:60,seventieth:70,eightieth:80,ninetieth:90,twenty:20,thirty:30,forty:40,fourty:40,fifty:50,sixty:60,seventy:70,eighty:80,ninety:90},multiples:{hundredth:100,thousandth:1e3,millionth:1e6,billionth:1e9,trillionth:1e12,quadrillionth:1e15,quintillionth:1e18,sextillionth:1e21,septillionth:1e24,hundred:100,thousand:1e3,million:1e6,billion:1e9,trillion:1e12,quadrillion:1e15,quintillion:1e18,sextillion:1e21,septillion:1e24,grand:1e3}},l=function(e,t){if(o.ones.hasOwnProperty(e)){if(t.ones||t.teens)return!1}else if(o.teens.hasOwnProperty(e)){if(t.ones||t.teens||t.tens)return!1}else if(o.tens.hasOwnProperty(e)&&(t.ones||t.teens||t.tens))return!1;return!0},s=function(e){for(var t="0.",n=0;n<e.length;n++){var r=e[n];if(!0===o.ones.hasOwnProperty(r))t+=o.ones[r];else if(!0===o.teens.hasOwnProperty(r))t+=o.teens[r];else if(!0===o.tens.hasOwnProperty(r))t+=o.tens[r];else{if(!0!==/^[0-9]$/.test(r))return 0;t+=r}}return parseFloat(t)},f=function(e){return e=(e=(e=(e=(e=(e=(e=(e=e.replace(/1st$/,"1")).replace(/2nd$/,"2")).replace(/3rd$/,"3")).replace(/([4567890])r?th$/,"$1")).replace(/^[$€¥£¢]/,"")).replace(/[%$€¥£¢]$/,"")).replace(/,/g,"")).replace(/([0-9])([a-z\u00C0-\u00FF]{1,2})$/,"$1")},h=/^([0-9,\. ]+)\/([0-9,\. ]+)$/,c={"a couple":2,"a dozen":12,"two dozen":24,zero:0},p=function(e){return Object.keys(e).reduce((function(t,n){return t+=e[n]}),0)},d=function(e){if(!0===c.hasOwnProperty(e))return c[e];if("a"===e||"an"===e)return 1;for(var t=a(e),n=null,r={},i=0,u=!1,d=(e=t.str).split(/[ -]/),m=0;m<d.length;m++){var y=d[m];if((y=f(y))&&"and"!==y)if("-"!==y&&"negative"!==y){if("-"===y.charAt(0)&&(u=!0,y=y.substr(1)),"point"===y)return i+=p(r),i+=s(d.slice(m+1,d.length)),i*=t.amount;var v=y.match(h);if(v){var g=parseFloat(v[1].replace(/[, ]/g,"")),x=parseFloat(v[2].replace(/[, ]/g,""));x&&(i+=g/x||0)}else{if(!1===l(y,r))return null;if(/^[0-9\.]+$/.test(y))r.ones=parseFloat(y);else if(!0===o.ones.hasOwnProperty(y))r.ones=o.ones[y];else if(!0===o.teens.hasOwnProperty(y))r.teens=o.teens[y];else if(!0===o.tens.hasOwnProperty(y))r.tens=o.tens[y];else if(!0===o.multiples.hasOwnProperty(y)){var O=o.multiples[y];if(O===n)return null;if(100===O&&void 0!==d[m+1]){var b=d[m+1];o.multiples[b]&&(O*=o.multiples[b],m+=1)}null===n||O<n?(i+=(p(r)||1)*O,n=O,r={}):(n=O,i=((i+=p(r))||1)*O,r={})}}}else u=!0}return i+=p(r),i*=t.amount,0===(i*=u?-1:1)&&0===Object.keys(r).length?null:i},m=function(e){var t=e.text("reduced"),n=/[0-9],[0-9]/.test(e.text("text")),r=(t=t.replace(/,/g,"")).split(/^([^0-9]*)([0-9.,]*)([^0-9]*)$/);if(r&&r[2]&&e.terms().length<2){var i=parseFloat(r[2]||t);"number"!=typeof i&&(i=null);var u=r[3]||"";return"st"!==u&&"nd"!==u&&"rd"!==u&&"th"!==u||(u=""),"m"!==u&&"M"!==u||(i*=1e6,u=""),"k"!==u&&"k"!==u||(i*=1e3,u=""),{hasComma:n,prefix:r[1]||"",num:i,suffix:u}}return{hasComma:n,prefix:"",num:d(t),suffix:""}},y=function(e,t,n){if(!1!==e){var r=t.lookAhead("^(#Unit|#Noun)");r.has("(#Address|#Money|#Percent)")||t.has("#Ordinal")||(1===n.num?r.nouns().toSingular():r.has("#Singular")&&r.nouns().toPlural())}},v=function(e){return e<1e6?String(e):-1===(t="number"==typeof e?e.toFixed(0):e).indexOf("e+")?t:t.replace(".","").split("e+").reduce((function(e,t){return e+Array(t-e.length+2).join(0)}));var t},g=[["ninety",90],["eighty",80],["seventy",70],["sixty",60],["fifty",50],["forty",40],["thirty",30],["twenty",20]],x=["","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve","thirteen","fourteen","fifteen","sixteen","seventeen","eighteen","nineteen"],O=[[1e24,"septillion"],[1e20,"hundred sextillion"],[1e21,"sextillion"],[1e20,"hundred quintillion"],[1e18,"quintillion"],[1e17,"hundred quadrillion"],[1e15,"quadrillion"],[1e14,"hundred trillion"],[1e12,"trillion"],[1e11,"hundred billion"],[1e9,"billion"],[1e8,"hundred million"],[1e6,"million"],[1e5,"hundred thousand"],[1e3,"thousand"],[100,"hundred"],[1,"one"]],b=function(e){var t=[];if(e>100)return t;for(var n=0;n<g.length;n++)e>=g[n][1]&&(e-=g[n][1],t.push(g[n][0]));return x[e]&&t.push(x[e]),t},w=function(e){if(0===e||"0"===e)return"zero";e>1e21&&(e=v(e));var t=[];e<0&&(t.push("minus"),e=Math.abs(e));for(var n=function(e){var t=e,n=[];return O.forEach((function(r){if(e>=r[0]){var i=Math.floor(t/r[0]);t-=i*r[0],i&&n.push({unit:r[1],count:i})}})),n}(e),r=0;r<n.length;r++){var i=n[r].unit;"one"===i&&(i="",t.length>1&&t.push("and")),(t=t.concat(b(n[r].count))).push(i)}return 0===(t=(t=t.concat(function(e){var t=["zero","one","two","three","four","five","six","seven","eight","nine"],n=[],r=v(e).match(/\.([0-9]+)/);if(!r||!r[0])return n;n.push("point");for(var i=r[0].split(""),u=0;u<i.length;u++)n.push(t[i[u]]);return n}(e))).filter((function(e){return e}))).length&&(t[0]=""),t.join(" ")},V=function(e){if(!e&&0!==e)return null;var t=e%100;if(t>10&&t<20)return String(e)+"th";var n={0:"th",1:"st",2:"nd",3:"rd"},r=v(e),i=r.slice(r.length-1,r.length);return r+=n[i]?n[i]:"th"},C={one:"first",two:"second",three:"third",five:"fifth",eight:"eighth",nine:"ninth",twelve:"twelfth",twenty:"twentieth",thirty:"thirtieth",forty:"fortieth",fourty:"fourtieth",fifty:"fiftieth",sixty:"sixtieth",seventy:"seventieth",eighty:"eightieth",ninety:"ninetieth"},P=function(e){var t=w(e).split(" "),n=t[t.length-1];return C.hasOwnProperty(n)?t[t.length-1]=C[n]:t[t.length-1]=n.replace(/y$/,"i")+"th",t.join(" ")},N={"¢":"cents",$:"dollars","£":"pounds","¥":"yen","€":"euros","₡":"colón","฿":"baht","₭":"kip","₩":"won","₹":"rupees","₽":"ruble","₺":"liras"},$={"%":"percent",s:"seconds",cm:"centimetres",km:"kilometres"},j={usd:!0,eur:!0,jpy:!0,gbp:!0,cad:!0,aud:!0,chf:!0,cny:!0,hkd:!0,nzd:!0,kr:!0,rub:!0},E=function(e){return N.hasOwnProperty(e.prefix)&&(e.suffix+=N[e.prefix],e.prefix=""),$.hasOwnProperty(e.suffix)&&(e.suffix=$[e.suffix]),j.hasOwnProperty(e.suffix)&&(e.suffix=e.suffix.toUpperCase()),e.suffix&&(e.suffix=" "+e.suffix),e},M=function(e,t,n){var r=String(e.num);return t?(e=E(e),n?(r=P(r),"".concat(e.prefix||"").concat(r).concat(e.suffix||"")):(r=w(r),"".concat(e.prefix||"").concat(r).concat(e.suffix||""))):n?(r=V(r),e=E(e),"".concat(e.prefix||"").concat(r).concat(e.suffix||"")):(!0===e.hasComma&&(r=e.num.toLocaleString()),r=v(r),"".concat(e.prefix||"").concat(r).concat(e.suffix||""))},q={json:function(e){var t=null;"number"==typeof e&&(t=e,e=null),e=e||{text:!0,normal:!0,trim:!0,terms:!0};var n=[];return this.forEach((function(t){var r=t.json(e)[0],i=m(t);r.prefix=i.prefix,r.number=i.num,r.suffix=i.suffix,r.cardinal=M(i,!1,!1),r.ordinal=M(i,!1,!0),r.textCardinal=M(i,!0,!1),r.textOrdinal=M(i,!0,!0),n.push(r)})),null!==t?n[t]:n},units:function(){return this.lookAhead("^(#Unit|#Noun)")},isOrdinal:function(){return this.if("#Ordinal")},isCardinal:function(){return this.if("#Cardinal")},toNumber:function(){return this.forEach((function(e){var t=m(e);if(null!==t.num){var n=M(t,!1,e.has("#Ordinal"));e.replaceWith(n,!0),e.tag("NumericValue")}})),this},toLocaleString:function(){return this.forEach((function(e){var t=m(e);if(null!==t.num){t.num=t.num.toLocaleString();var n=M(t,!1,e.has("#Ordinal"));e.replaceWith(n,!0)}})),this},toText:function(){return this.forEach((function(e){var t=m(e);if(null!==t.num){var n=M(t,!0,e.has("#Ordinal"));e.replaceWith(n,!0),e.tag("TextValue")}})),this},toCardinal:function(e){return this.if("#Ordinal").forEach((function(t){var n=m(t);if(null!==n.num){var r=M(n,t.has("#TextValue"),!1);t.replaceWith(r,!0),t.tag("Cardinal"),y(e,t,n)}})),this},toOrdinal:function(){var e=this;return this.if("#Cardinal").forEach((function(t){var n=m(t);if(null!==n.num){var r=M(n,t.has("#TextValue"),!0);t.replaceWith(r,!0),t.tag("Ordinal");var i=e.lookAhead("^#Plural");i.found&&i.nouns().toSingular()}})),this},isEqual:function(e){return this.filter((function(t){return m(t).num===e}))},greaterThan:function(e){return this.filter((function(t){return m(t).num>e}))},lessThan:function(e){return this.filter((function(t){return m(t).num<e}))},between:function(e,t){return this.filter((function(n){var r=m(n).num;return r>e&&r<t}))},set:function(e,t){return void 0===e?this:("string"==typeof e&&(e=d(e)),this.forEach((function(n){var r=m(n);if(r.num=e,null!==r.num){var i=M(r,n.has("#TextValue"),n.has("#Ordinal"));n.replaceWith(i,!0),y(t,n,r)}})),this)},add:function(e,t){return e?("string"==typeof e&&(e=d(e)),this.forEach((function(n){var r=m(n);if(null!==r.num){r.num+=e;var i=M(r,n.has("#TextValue"),n.has("#Ordinal"));n.replaceWith(i,!0),y(t,n,r)}})),this):this},subtract:function(e,t){return this.add(-1*e,t)},increment:function(e){return this.add(1,e),this},decrement:function(e){return this.add(-1,e),this},fractions:function(e){var t=this.match("#Fraction");return"number"==typeof e&&(t=t.get(e)),t},romanNumerals:function(e){var t=this.match("#RomanNumeral").numbers();return"number"==typeof e&&(t=t.get(e)),t},money:function(e){var t=this.splitOn("@hasComma");return t=(t=t.match("#Money+ #Currency?")).numbers(),"number"==typeof e&&(t=t.get(e)),t}};q.toNice=q.toLocaleString,q.isBetween=q.between,q.minus=q.subtract,q.plus=q.add,q.equals=q.isEqual;var A=q,T=function(e){e.match("(hundred|thousand|million|billion|trillion|quadrillion|quintillion|sextillion|septillion)").tag("#Multiple"),e.match("the [/[0-9]+s$/]").tag("#Plural"),e.match("half a? #Value").tag("Value","half-a-value"),e.match("#Value and a (half|quarter)").tag("Value","value-and-a-half"),e.match("#Money and #Money #Currency?").tag("Money","money-and-money")},k={Fraction:{isA:"Value"},Multiple:{isA:"Value"}};return function(i,a){a.addTags(k),a.postProcess(T);var o=function(i){function u(){return e(this,u),r(this,t(u).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}(u,i),u}(i);return Object.assign(o.prototype,A),i.prototype.numbers=function(e){var t=u(this,e);return new o(t.list,this,this.world)},i.prototype.values=i.prototype.numbers,i}}));
